{"version":3,"sources":["../src/Projection.js"],"names":["r_major","r_minor","f","deg2rad","d","r","Math","PI","rad2deg","ll2m","lon","lat","x","temp","es","eccent","sqrt","phi","sinphi","sin","con","com","con2","pow","ts","tan","y","log","ret","m2ll","e","pj_phi2","exp","N_ITER","HALFPI","TOL","eccnth","Phi","dphi","i","atan","abs"],"mappings":";;;;;AAAA;;kBAEgB;AACZA,iBAAS,SADG,EACO;AACnBC,iBAAS,iBAFG,EAEe;AAC3BC,WAAG,aAHS,EAGK;AACjBC,iBAAS,iBAAUC,CAAV,EAAa;AAClB,oBAAIC,IAAID,KAAKE,KAAKC,EAAL,GAAU,KAAf,CAAR;AACA,uBAAOF,CAAP;AACH,SAPW;AAQZG,iBAAS,iBAAUH,CAAV,EAAa;AAClB,oBAAID,IAAIC,KAAKC,KAAKC,EAAL,GAAU,KAAf,CAAR;AACA,uBAAOH,CAAP;AACH,SAXW;AAYZK,cAAM,cAAUC,GAAV,EAAeC,GAAf,EAAoB;AAC1B;AACI;AACA,oBAAIC,IAAI,KAAKZ,OAAL,GAAe,KAAKG,OAAL,CAAaO,GAAb,CAAvB;;AAEA,oBAAIC,MAAM,IAAV,EAAgBA,MAAM,IAAN;AAChB,oBAAIA,MAAM,CAAC,IAAX,EAAiBA,MAAM,CAAC,IAAP;;AAGjB,oBAAIE,OAAO,KAAKZ,OAAL,GAAe,KAAKD,OAA/B;AACA,oBAAIc,KAAK,MAAOD,OAAOA,IAAvB;AACA,oBAAIE,SAAST,KAAKU,IAAL,CAAUF,EAAV,CAAb;;AAEA,oBAAIG,MAAM,KAAKd,OAAL,CAAaQ,GAAb,CAAV;;AAEA,oBAAIO,SAASZ,KAAKa,GAAL,CAASF,GAAT,CAAb;;AAEA,oBAAIG,MAAML,SAASG,MAAnB;AACA,oBAAIG,MAAM,KAAKN,MAAf;AACA,oBAAIO,OAAOhB,KAAKiB,GAAL,CAAS,CAAC,MAAMH,GAAP,KAAe,MAAMA,GAArB,CAAT,EAAoCC,GAApC,CAAX;AACA,oBAAIG,KAAKlB,KAAKmB,GAAL,CAAS,MAAMnB,KAAKC,EAAL,GAAU,GAAV,GAAgBU,GAAtB,CAAT,IAAuCK,IAAhD;AACA,oBAAII,IAAI,IAAI,KAAK1B,OAAL,GAAeM,KAAKqB,GAAL,CAASH,EAAT,CAA3B;AACA,oBAAII,MAAM,EAAE,KAAKhB,CAAP,EAAU,KAAKc,CAAf,EAAV;AACA,uBAAOE,GAAP;AACH,SApCW;AAqCZC,cAAM,cAAUjB,CAAV,EAAac,CAAb,EAAgB;AACtB;AACI,oBAAIhB,MAAM,KAAKF,OAAL,CAAcI,IAAI,KAAKZ,OAAvB,CAAV;;AAEA,oBAAIa,OAAO,KAAKZ,OAAL,GAAe,KAAKD,OAA/B;AACA,oBAAI8B,IAAIxB,KAAKU,IAAL,CAAU,MAAOH,OAAOA,IAAxB,CAAR;AACA,oBAAIF,MAAM,KAAKH,OAAL,CAAa,KAAKuB,OAAL,CAAazB,KAAK0B,GAAL,CAAS,IAAKN,IAAI,KAAK1B,OAAvB,CAAb,EAA+C8B,CAA/C,CAAb,CAAV;;AAEA,oBAAIF,MAAM,EAAE,OAAOlB,GAAT,EAAc,OAAOC,GAArB,EAAV;AACA,uBAAOiB,GAAP;AACH,SA/CW;AAgDZG,iBAAS,iBAAUP,EAAV,EAAcM,CAAd,EAAiB;AACtB,oBAAIG,SAAS,EAAb;AACA,oBAAIC,SAAS5B,KAAKC,EAAL,GAAU,CAAvB;;AAGA,oBAAI4B,MAAM,YAAV;AACA,oBAAIC,MAAJ,EAAYC,GAAZ,EAAiBjB,GAAjB,EAAsBkB,IAAtB;AACA,oBAAIC,CAAJ;AACA,oBAAIH,SAAS,KAAKN,CAAlB;AACAO,sBAAMH,SAAS,KAAK5B,KAAKkC,IAAL,CAAUhB,EAAV,CAApB;AACAe,oBAAIN,MAAJ;AACA,mBAAG;AACCb,8BAAMU,IAAIxB,KAAKa,GAAL,CAASkB,GAAT,CAAV;AACAC,+BAAOJ,SAAS,KAAK5B,KAAKkC,IAAL,CAAUhB,KAAKlB,KAAKiB,GAAL,CAAS,CAAC,KAAKH,GAAN,KAAc,KAAKA,GAAnB,CAAT,EAAkCgB,MAAlC,CAAf,CAAd,GAA0EC,GAAjF;AACAA,+BAAOC,IAAP;AAEH,iBALD,QAMOhC,KAAKmC,GAAL,CAASH,IAAT,IAAiBH,GAAjB,IAAwB,EAAEI,CANjC;AAOA,uBAAOF,GAAP;AACH;AAnEW,C;;AAsEhB;AACA;AACA","file":"Projection.js","sourcesContent":["// Reference http://wiki.openstreetmap.org/wiki/Mercator#JavaScript\r\n\r\nexport default ({\r\n    r_major: 6378137.0,//Equatorial Radius, WGS84\r\n    r_minor: 6356752.314245179,//defined as constant\r\n    f: 298.257223563,//1/f=(a-b)/a , a=r_major, b=r_minor\r\n    deg2rad: function (d) {\r\n        var r = d * (Math.PI / 180.0);\r\n        return r;\r\n    },\r\n    rad2deg: function (r) {\r\n        var d = r / (Math.PI / 180.0);\r\n        return d;\r\n    },\r\n    ll2m: function (lon, lat) //lat lon to mercator\r\n    {\r\n        //lat, lon in rad\r\n        var x = this.r_major * this.deg2rad(lon);\r\n\r\n        if (lat > 89.5) lat = 89.5;\r\n        if (lat < -89.5) lat = -89.5;\r\n\r\n\r\n        var temp = this.r_minor / this.r_major;\r\n        var es = 1.0 - (temp * temp);\r\n        var eccent = Math.sqrt(es);\r\n\r\n        var phi = this.deg2rad(lat);\r\n\r\n        var sinphi = Math.sin(phi);\r\n\r\n        var con = eccent * sinphi;\r\n        var com = .5 * eccent;\r\n        var con2 = Math.pow((1.0 - con) / (1.0 + con), com);\r\n        var ts = Math.tan(.5 * (Math.PI * 0.5 - phi)) / con2;\r\n        var y = 0 - this.r_major * Math.log(ts);\r\n        var ret = { 'x': x, 'y': y };\r\n        return ret;\r\n    },\r\n    m2ll: function (x, y) //mercator to lat lon\r\n    {\r\n        var lon = this.rad2deg((x / this.r_major));\r\n\r\n        var temp = this.r_minor / this.r_major;\r\n        var e = Math.sqrt(1.0 - (temp * temp));\r\n        var lat = this.rad2deg(this.pj_phi2(Math.exp(0 - (y / this.r_major)), e));\r\n\r\n        var ret = { 'lon': lon, 'lat': lat };\r\n        return ret;\r\n    },\r\n    pj_phi2: function (ts, e) {\r\n        var N_ITER = 15;\r\n        var HALFPI = Math.PI / 2;\r\n\r\n\r\n        var TOL = 0.0000000001;\r\n        var eccnth, Phi, con, dphi;\r\n        var i;\r\n        var eccnth = .5 * e;\r\n        Phi = HALFPI - 2. * Math.atan(ts);\r\n        i = N_ITER;\r\n        do {\r\n            con = e * Math.sin(Phi);\r\n            dphi = HALFPI - 2. * Math.atan(ts * Math.pow((1. - con) / (1. + con), eccnth)) - Phi;\r\n            Phi += dphi;\r\n\r\n        }\r\n        while (Math.abs(dphi) > TOL && --i);\r\n        return Phi;\r\n    }\r\n});\r\n\r\n//usage\r\n// var mercator = Conv.ll2m(47.6035525, 9.770602);//output mercator.x, mercator.y\r\n// var latlon = Conv.m2ll(5299424.36041, 1085840.05328);//output latlon.lat, latlon.lon"]}